# Руководство по демо-режиму

## Что такое демо-режим?

Демо-режим позволяет работать с приложением без подключения к серверу, используя локальные данные. Это полезно для:
- Демонстрации функционала
- Тестирования интерфейса
- Работы без доступа к серверу
- Обучения новых пользователей

## Как войти в демо-режим?

1. Откройте страницу входа
2. Нажмите кнопку **"Войти без авторизации"**
3. Приложение переключится на использование демо-данных

## Данные в демо-режиме

### Текущие демо-данные

В демо-режиме используются данные из файлов:
- `src/data/demo/doctypes.json` - типы документов
- `src/data/demo/documents.json` - документы
- Автоматически генерируемые товары (5 демо-позиций на документ)

### Автоматические демо-товары

Когда вы открываете документ в демо-режиме, система автоматически добавляет 5 демо-товаров:

1. **Ноутбук Dell XPS 15** - полностью выполнено (10/10)
2. **Монитор Samsung 27"** - полностью выполнено (15/15)
3. **Клавиатура Logitech MX Keys** - частично выполнено (18/25)
4. **Мышь Logitech MX Master 3** - частично выполнено (12/20)
5. **Наушники Sony WH-1000XM5** - частично выполнено (8/12)

Это позволяет демонстрировать различные статусы выполнения документов.

## Экспорт реальных данных с сервера

Если вы хотите использовать реальные данные из вашего сервера в демо-режиме, выполните следующие шаги:

### Использование скрипта экспорта

1. Откройте PowerShell в корневой папке проекта

2. Запустите скрипт экспорта:
   ```powershell
   .\scripts\extract-data-with-items.ps1
   ```

   Или с указанием пользовательских параметров:
   ```powershell
   .\scripts\extract-data-with-items.ps1 `
     -ServerUrl "http://your-server:9000/MobileSMARTS/api/v1" `
     -OutputDir "src/data/demo"
   ```

3. Скрипт извлечёт:
   - Все типы документов
   - Все документы с их товарами
   - Сохранит данные в `src/data/demo/`

### Параметры скрипта

- `ServerUrl` - URL вашего сервера (по умолчанию: `http://localhost:9000/MobileSMARTS/api/v1`)
- `OutputDir` - папка для сохранения данных (по умолчанию: `src/data/demo`)

### Что экспортируется?

Скрипт экспортирует:
- Типы документов (`DocTypes`)
- Документы всех типов
- Товары в документах:
  - `declaredItems` - плановые товары
  - `currentItems` - фактические товары
  - `combinedItems` - объединённые данные

### Пример вывода скрипта

```
==================================
Извлечение данных с сервера
Сервер: http://localhost:9000/MobileSMARTS/api/v1
==================================

[1/3] Получение типов документов...
✓ DocTypes сохранены: найдено 8 типов

[2/3] Получение документов...
  → Приход на склад (PrihodNaSklad)... ✓ 15 док., 78 товаров
  → Размещение (RazmeshhenieVYachejki)... ✓ 12 док., 65 товаров
  → Подбор заказа (PodborZakaza)... ✓ 20 док., 124 товаров
  ...

[3/3] Сохранение данных...
✓ Документы сохранены в: src/data/demo/documents.json

==================================
Готово!
Типов документов: 8
Всего документов: 95
Всего товаров: 467
Папка: src/data/demo
==================================
```

## Ограничения демо-режима

В демо-режиме недоступны:
- ❌ Синхронизация с сервером
- ❌ Сохранение изменений на сервере
- ❌ Создание новых документов
- ❌ Печать этикеток

Доступны:
- ✅ Просмотр документов
- ✅ Просмотр товаров
- ✅ Фильтрация и поиск
- ✅ Все UI-функции

## Выход из демо-режима

Чтобы выйти из демо-режима:
1. Откройте меню (☰)
2. Нажмите "Выход"
3. Войдите с реальными учётными данными

## Технические детали

### Как работает демо-режим?

1. При нажатии "Войти без авторизации" в `localStorage` устанавливается флаг `demo_mode = 'true'`
2. API-сервис проверяет этот флаг перед каждым запросом
3. Если демо-режим активен, данные берутся из `demoDataService` вместо сервера
4. `demoDataService` загружает данные из JSON-файлов и генерирует демо-товары

### Структура демо-данных

```typescript
// src/data/demo/doctypes.json
{
  "value": [
    {
      "uni": "PrihodNaSklad",
      "displayName": "Приход на склад",
      ...
    }
  ]
}

// src/data/demo/documents.json
{
  "PrihodNaSklad": [
    {
      "id": "doc-001",
      "name": "Приход №123",
      "states": [...] // товары
    }
  ]
}
```

### Файлы демо-режима

- `src/services/demoDataService.ts` - сервис для работы с демо-данными
- `src/services/api.ts` - проверка демо-режима перед API-запросами
- `src/services/odataCache.ts` - кеширование и fallback на демо-данные
- `scripts/extract-data-with-items.ps1` - скрипт экспорта данных

## Часто задаваемые вопросы

**Q: Почему в документах нет товаров?**
A: Если вы экспортировали данные старым скриптом, используйте новый `extract-data-with-items.ps1`, который экспортирует товары вместе с документами.

**Q: Можно ли редактировать демо-данные?**
A: Да, вы можете редактировать JSON-файлы в `src/data/demo/` вручную или экспортировать новые данные с сервера.

**Q: Как добавить больше демо-товаров?**
A: Отредактируйте метод `generateDemoItems()` в файле `src/services/demoDataService.ts`.

**Q: Демо-данные сохраняются между сессиями?**
A: Да, демо-данные хранятся в исходниках приложения и не меняются между сессиями.
