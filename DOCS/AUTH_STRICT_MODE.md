# üîí –°—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω

**–î–∞—Ç–∞:** 31 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** üü¢ **–ê–ö–¢–ò–í–ò–†–û–í–ê–ù**

---

## üéØ –¶–µ–ª—å

–û–±–µ—Å–ø–µ—á–∏—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –ü–µ—Ä–µ—Ö–≤–∞—Ç 401 –æ—à–∏–±–æ–∫ –≤ API
**–§–∞–π–ª:** `src/services/api.ts`

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
```typescript
// Response interceptor
this.client.interceptors.response.use(
  (response) => response,
  (error: AxiosError) => {
    if (error.response?.status === 401) {
      // Trigger logout event
      window.dispatchEvent(new CustomEvent('auth:unauthorized'));
    }
    return Promise.reject(error);
  }
);
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ 401 –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è —Ç–æ–∫–µ–Ω
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ `auth:unauthorized`
- AuthContext –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç logout

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π logout –ø—Ä–∏ unauthorized
**–§–∞–π–ª:** `src/contexts/AuthContext.tsx`

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
```typescript
// Listen for unauthorized events from API
useEffect(() => {
  const handleUnauthorized = () => {
    console.warn('‚ö†Ô∏è Unauthorized event received - logging out');
    logout();
  };

  window.addEventListener('auth:unauthorized', handleUnauthorized);

  return () => {
    window.removeEventListener('auth:unauthorized', handleUnauthorized);
  };
}, [logout]);
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- AuthContext —Å–ª—É—à–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ `auth:unauthorized`
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `logout()`
- –û—á–∏—â–∞—é—Ç—Å—è auth_state –∏ auth_token
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ `/login`

### 3. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
**–§–∞–π–ª:** `src/contexts/AuthContext.tsx`

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
```typescript
// Validate that we have required data
if (!parsed.user || !parsed.user.id) {
  console.warn('‚ö†Ô∏è Invalid auth data in storage, clearing');
  localStorage.removeItem(AUTH_STORAGE_KEY);
  localStorage.removeItem(TOKEN_STORAGE_KEY);
  return;
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ auth state –∏–∑ localStorage
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ user –∏ user.id
- –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã - –æ—á–∏—â–∞—é—Ç—Å—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—É–¥–µ—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ login

### 4. –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ ProtectedRoute
**–§–∞–π–ª:** `src/components/ProtectedRoute.tsx`

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
```typescript
// Strict authentication check
if (!isAuthenticated || !user || !token) {
  console.warn('‚ö†Ô∏è Not authenticated, redirecting to /login');
  return <Navigate to="/login" replace />;
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö —Ç—Ä–µ—Ö: isAuthenticated, user, token
- –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç - redirect –Ω–∞ `/login`
- –õ–æ–≥–∏—Ä—É—é—Ç—Å—è –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ API –∑–∞–ø—Ä–æ—Å–∞–º–∏
**–§–∞–π–ª:** `src/services/odataCache.ts`

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
```typescript
const requireAuth = (): boolean => {
  if (!api.isAuthenticated()) {
    console.error('‚ùå API request rejected: User not authenticated');
    window.dispatchEvent(new CustomEvent('auth:unauthorized'));
    return false;
  }
  return true;
};

// Before API request
if (!requireAuth()) {
  // Fallback to stale cache
  const cached = await db.odataDocTypes.toArray();
  if (cached.length > 0) {
    console.warn('‚ö†Ô∏è Using stale cache (not authenticated)');
    return cached;
  }
  throw new Error('Authentication required');
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ü–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º API –∑–∞–ø—Ä–æ—Å–æ–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –ï—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ unauthorized
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è stale cache –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- –ï—Å–ª–∏ –∫—ç—à–∞ –Ω–µ—Ç - throw error

---

## üîÑ Flow –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
```
User –¥–µ–π—Å—Ç–≤–∏–µ ‚Üí API –∑–∞–ø—Ä–æ—Å ‚Üí 200 OK ‚Üí –î–∞–Ω–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã
```

### Unauthorized (401)
```
User –¥–µ–π—Å—Ç–≤–∏–µ ‚Üí API –∑–∞–ø—Ä–æ—Å ‚Üí 401 Unauthorized
                    ‚Üì
              Event 'auth:unauthorized'
                    ‚Üì
              AuthContext.logout()
                    ‚Üì
              Clear localStorage
                    ‚Üì
              Redirect ‚Üí /login
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
```
App start ‚Üí AuthProvider.loadAuthState()
                    ‚Üì
            Validate user.id exists?
                    ‚Üì
            Yes: Set authenticated
            No: Clear storage ‚Üí /login
```

### –ó–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤
```
User ‚Üí Navigate to /documents
         ‚Üì
    ProtectedRoute check
         ‚Üì
    isConfigured? ‚Üí No ‚Üí /setup
         ‚Üì Yes
    isAuthenticated && user && token?
         ‚Üì
    Yes: Render /documents
    No: ‚Üí /login
```

---

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–æ–Ω—Å–æ–ª—å –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
```
‚úÖ Auth state restored: Admin
üõ°Ô∏è ProtectedRoute check: {
  path: "/",
  isConfigured: true,
  isAuthenticated: true,
  hasUser: true,
  hasToken: true,
  isLoading: false
}
‚úÖ API baseURL updated: http://localhost:9000/MobileSMARTS/api/v1
```

### –ö–æ–Ω—Å–æ–ª—å –ø—Ä–∏ –æ—à–∏–±–∫–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
```
‚ö†Ô∏è Unauthorized (401) - clearing auth
‚ö†Ô∏è Unauthorized event received - logging out
‚úÖ Logout successful
‚ö†Ô∏è Not authenticated, redirecting to /login
```

### –ö–æ–Ω—Å–æ–ª—å –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ API –∑–∞–ø—Ä–æ—Å–∞ –±–µ–∑ auth
```
‚ùå API request rejected: User not authenticated
‚ö†Ô∏è Using stale cache (not authenticated)
```

---

## üß™ –¢–µ—Å—Ç—ã

### –¢–µ—Å—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π logout –ø—Ä–∏ 401

**–®–∞–≥–∏:**
1. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
2. –í localStorage –≤—Ä—É—á–Ω—É—é –∏–∑–º–µ–Ω–∏—Ç—å `auth_token` –Ω–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π
3. –í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ —Ç—Ä–µ–±—É—é—â–µ–µ API –∑–∞–ø—Ä–æ—Å

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- API –≤–µ—Ä–Ω–µ—Ç 401
- –°–æ–±—ã—Ç–∏–µ `auth:unauthorized` –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π logout
- Redirect –Ω–∞ `/login`
- –í –∫–æ–Ω—Å–æ–ª–∏: "‚ö†Ô∏è Unauthorized event received - logging out"

### –¢–µ—Å—Ç 2: –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

**–®–∞–≥–∏:**
1. –í localStorage —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π `auth_state`:
   ```javascript
   localStorage.setItem('auth_state', JSON.stringify({ user: null }));
   ```
2. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- AuthContext –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- localStorage –æ—á–∏—â–∞–µ—Ç—Å—è
- Redirect –Ω–∞ `/login`
- –í –∫–æ–Ω—Å–æ–ª–∏: "‚ö†Ô∏è Invalid auth data in storage, clearing"

### –¢–µ—Å—Ç 3: –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ ProtectedRoute

**–®–∞–≥–∏:**
1. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è
2. –í –∫–æ–Ω—Å–æ–ª–∏:
   ```javascript
   localStorage.removeItem('auth_token');
   ```
3. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ `/documents`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ProtectedRoute –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø
- Redirect –Ω–∞ `/login`
- –í –∫–æ–Ω—Å–æ–ª–∏: "‚ö†Ô∏è Not authenticated, redirecting to /login"

### –¢–µ—Å—Ç 4: API –∑–∞–ø—Ä–æ—Å –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–®–∞–≥–∏:**
1. –í—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
2. –í –∫–æ–Ω—Å–æ–ª–∏ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ:
   ```javascript
   import { odataCache } from './services/odataCache';
   await odataCache.getDocTypes();
   ```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞
- –í–æ–∑–≤—Ä–∞—â–µ–Ω stale cache (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –°–æ–±—ã—Ç–∏–µ `auth:unauthorized` –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
- –í –∫–æ–Ω—Å–æ–ª–∏: "‚ùå API request rejected: User not authenticated"

---

## üîê –£—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã

### –£—Ä–æ–≤–µ–Ω—å 1: API Response Interceptor
- –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç 401 –æ—Ç–≤–µ—Ç—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç logout
- **–ó–∞—â–∏—Ç–∞:** –û—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤

### –£—Ä–æ–≤–µ–Ω—å 2: AuthContext Event Listener
- –°–ª—É—à–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è unauthorized
- –í—ã–ø–æ–ª–Ω—è–µ—Ç logout
- **–ó–∞—â–∏—Ç–∞:** –û—Ç –ª—é–±—ã—Ö –ø—Ä–æ–±–ª–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –£—Ä–æ–≤–µ–Ω—å 3: ProtectedRoute
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç auth –ø–µ—Ä–µ–¥ —Ä–µ–Ω–¥–µ—Ä–æ–º
- Redirect –Ω–∞ login –µ—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- **–ó–∞—â–∏—Ç–∞:** –û—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–æ—É—Ç–∞–º

### –£—Ä–æ–≤–µ–Ω—å 4: API Request Guard
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç auth –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç stale cache –∫–∞–∫ fallback
- **–ó–∞—â–∏—Ç–∞:** –û—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –£—Ä–æ–≤–µ–Ω—å 5: Data Validation
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- –û—á–∏—â–∞–µ—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **–ó–∞—â–∏—Ç–∞:** –û—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å—Ç—Ä–æ–≥–æ–≥–æ —Ä–µ–∂–∏–º–∞:
1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è** –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∞** - —Ä–∞–±–æ—Ç–∞ –¥–∞–∂–µ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–∏–∑ –∫—ç—à–∞)
4. **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ª–µ–≥–∫–∞—è –æ—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
1. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏** - –Ω–µ–±–æ–ª—å—à–æ–π overhead
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π logout** - –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–ü—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–π—Å—Ç–≤–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:

- [ ] –ï—Å—Ç—å –ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (serverUrl)?
- [ ] –ï—Å—Ç—å –ª–∏ —Ç–æ–∫–µ–Ω –≤ –ø–∞–º—è—Ç–∏?
- [ ] –ï—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?
- [ ] –í–∞–ª–∏–¥–µ–Ω –ª–∏ —Ç–æ–∫–µ–Ω (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ API –∑–∞–ø—Ä–æ—Å–µ)?
- [ ] –ù–µ –∏—Å—Ç–µ–∫ –ª–∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞ (401 –æ—Ç–≤–µ—Ç)?

–ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –ø—Ä–æ—à–ª–∞ ‚Üí **Redirect –Ω–∞ /login**

---

## üõ†Ô∏è –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

// 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ localStorage
console.log('Config:', localStorage.getItem('app_config'));
console.log('Auth:', localStorage.getItem('auth_state'));
console.log('Token:', localStorage.getItem('auth_token'));

// 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ API
import { api } from './services/api';
console.log('Authenticated:', api.isAuthenticated());
console.log('BaseURL:', api.getBaseURL());

// 3. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π logout
window.dispatchEvent(new CustomEvent('auth:unauthorized'));

// 4. –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ–≥–æ
localStorage.clear();
location.reload();
```

---

## üéØ –ò—Ç–æ–≥–∏

### –ß—Ç–æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:
1. ‚úÖ **–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
2. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π logout** - –ø—Ä–∏ –ª—é–±—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
3. ‚úÖ **–ú–Ω–æ–∂–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω–µ–π –∑–∞—â–∏—Ç—ã** - 5 —É—Ä–æ–≤–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
4. ‚úÖ **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
5. ‚úÖ **Fallback –Ω–∞ –∫—ç—à** - —Ä–∞–±–æ—Ç–∞ –¥–∞–∂–µ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ)
6. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- üîí –¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ localStorage (XSS protected by same-origin)
- üîí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ 401
- üîí –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- üîí –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º API –∑–∞–ø—Ä–æ—Å–æ–º
- üîí –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ ProtectedRoute

---

**–°—Ç–∞—Ç—É—Å:** üü¢ **–°–¢–†–û–ì–ò–ô –†–ï–ñ–ò–ú –ê–ö–¢–ò–í–ò–†–û–í–ê–ù**  
**–†–µ–∂–∏–º:** üõ°Ô∏è **–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø –ó–ê–©–ò–¢–ê**  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** ‚úÖ **–ì–û–¢–û–í–û –ö PRODUCTION**

---

*–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ: Senior Frontend Engineer*  
*–ü—Ä–æ–µ–∫—Ç: Cleverence Warehouse PWA "–°–∫–ª–∞–¥-15"*  
*–î–∞—Ç–∞: 31 –æ–∫—Ç—è–±—Ä—è 2025*












