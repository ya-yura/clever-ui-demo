# üìä –ú–æ–¥—É–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (—á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
**–í–µ—Ä—Å–∏—è:** 0.5.0

## 1. –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤ "–°–∫–ª–∞–¥-15" –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –¥–≤—É—Ö —É—Ä–æ–≤–Ω—è—Ö:
1. **–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** ‚Äî –ø–æ–¥—Å—á–µ—Ç —Ç–µ–∫—É—â–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (IndexedDB).
2. **–°–æ–±—ã—Ç–∏–π–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** ‚Äî —Ç—Ä–µ–∫–∏–Ω–≥ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –æ—à–∏–±–æ–∫.

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 2.1 –ö–ª–∞—Å—Å Analytics (`src/analytics.ts`)

–û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–±–æ—Ä–∞ —Å–æ–±—ã—Ç–∏–π. –†–µ–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω Singleton.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ **Offline-first:** –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –≤ `localStorage` –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–µ—Ç–∏.
- ‚úÖ **–ü–∞–∫–µ—Ç–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:** –°–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–∞—á–∫–∞–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10 —à—Ç.) –∏–ª–∏ –ø–æ —Ç–∞–π–º–µ—Ä—É (30 —Å–µ–∫).
- ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `navigator.sendBeacon` –∏–ª–∏ `fetch` —Å `keepalive`.
- ‚úÖ **–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ, —Å–µ—Ç–∏, –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
```typescript
analytics.track(event, properties)       // –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
analytics.trackPageView(screenName)      // –ü—Ä–æ—Å–º–æ—Ç—Ä —ç–∫—Ä–∞–Ω–∞
analytics.trackScanSuccess(barcode, ...) // –£—Å–ø–µ—à–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
analytics.trackError(error)              // –û—à–∏–±–∫–∞
analytics.trackTiming(cat, var, time)    // –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
```

### 2.2 –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö (`src/services/db.ts`)

–î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è IndexedDB (—á–µ—Ä–µ–∑ Dexie.js).

**–¢–∞–±–ª–∏—Ü—ã –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**
- `activityEvents` (v5 schema) ‚Äî –∂—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ).
- `errorLogs` ‚Äî –∂—É—Ä–Ω–∞–ª –æ—à–∏–±–æ–∫.
- `syncActions` ‚Äî –∂—É—Ä–Ω–∞–ª –¥–µ–π—Å—Ç–≤–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.
- `*_Documents` ‚Äî —Ç–∞–±–ª–∏—Ü—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ KPI).

### 2.3 –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (`src/pages/Statistics.tsx`)

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏:** –ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å `count()` –∫ —Ç–∞–±–ª–∏—Ü–∞–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ IndexedDB.
- **–ú–µ—Ç—Ä–∏–∫–∏:**
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ —Ç–∏–ø–∞–º (–ü—Ä–∏–µ–º–∫–∞, –†–∞–∑–º–µ—â–µ–Ω–∏–µ –∏ —Ç.–¥.)
  - ‚ö†Ô∏è "–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è" (Hardcoded)
  - ‚ö†Ô∏è "–û—à–∏–±–æ–∫" (Hardcoded)
- **UI:** –°–µ—Ç–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ —Å —Ç—Ä–µ–Ω–¥–∞–º–∏.

## 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 3.1 –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å (`src/components/DynamicGridInterface.tsx`)
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç `analytics` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
- –ó–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ (`custom_interface.loaded`).
- –ö–ª–∏–∫–æ–≤ –ø–æ –∫–Ω–æ–ø–∫–∞–º (`custom_interface.button_click`).

### 3.2 –ü–æ–¥—Å—á–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (`src/services/documentCounter.ts`)
–°–µ—Ä–≤–∏—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ API (–∏–ª–∏ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö) –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –ø–ª–∏—Ç–∫–∞—Ö –º–µ–Ω—é.
- –ö–µ—à–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ `localStorage`.
- –û–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫.

## 4. –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è (Roadmap)

1. **–°–≤—è–∑—å Analytics –∏ DB:**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–ø–∏—Å—å —Å–æ–±—ã—Ç–∏–π –∏–∑ `Analytics` –≤ —Ç–∞–±–ª–∏—Ü—É `activityEvents`.
   - –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Å—Ç—Ä–æ–∏—Ç—å –æ—Ç—á–µ—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ –±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

2. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫:**
   - –†–µ–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç "–°—Ä–µ–¥–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏" –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–±—ã—Ç–∏–π `scan.success`.
   - –ü–æ–¥—Å—á–µ—Ç –æ—à–∏–±–æ–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (`scan.fail`).

3. **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–∫–∏–Ω–≥ –≤ `useScanner.ts` (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ).
   - –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–∫–∏–Ω–≥ –≤ `DocumentService` (–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤).

