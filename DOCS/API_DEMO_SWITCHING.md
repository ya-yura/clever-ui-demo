# üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–µ–º–æ-—Ä–µ–∂–∏–º–æ–º –∏ —Ä–µ–∞–ª—å–Ω—ã–º API

## –û–±–∑–æ—Ä

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Ä–µ–∞–ª—å–Ω—ã–π API –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã

### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞

**–î–µ–º–æ-—Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è, –µ—Å–ª–∏:**
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ñ–ª–∞–≥ `localStorage.getItem('demo_mode') === 'true'`
- –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã)
- –°–µ—Ä–≤–µ—Ä URL –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

**–†–µ–∞–ª—å–Ω—ã–π API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏:**
- –°–µ—Ä–≤–µ—Ä URL –Ω–∞—Å—Ç—Ä–æ–µ–Ω (`configService.isConfigured()`)
- –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω (—É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ `/DocTypes`)
- –§–ª–∞–≥ `demo_mode` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

### 2. –°–µ—Ä–≤–∏—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞

`src/services/serverHealth.ts`:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å `/DocTypes`
- –ö—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ 30 —Å–µ–∫—É–Ω–¥
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã

### 3. OData API —Å–µ—Ä–≤–∏—Å

`src/services/odata-api.ts`:
- –í—Å–µ –º–µ—Ç–æ–¥—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ä–µ–∂–∏–º —á–µ—Ä–µ–∑ `serverHealth.shouldUseDemoMode()`
- –ü—Ä–∏ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `demoDataService`
- –ü—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–º API –¥–µ–ª–∞—é—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ —Å–µ—Ä–≤–µ—Ä—É
- –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ fallback –Ω–∞ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –ß–µ—Ä–µ–∑ Setup —ç–∫—Ä–∞–Ω

1. –û—Ç–∫—Ä–æ–π—Ç–µ `/setup`
2. –í–≤–µ–¥–∏—Ç–µ URL —Å–µ—Ä–≤–µ—Ä–∞: `http://localhost:9000/MobileSMARTS/api/v1`
3. –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ" –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
4. –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å ‚Üí" –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è URL —Å–µ—Ä–≤–µ—Ä–∞ –≤ `localStorage`
- –û—á–∏—â–∞–µ—Ç—Å—è —Ñ–ª–∞–≥ `demo_mode`
- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è `baseURL` –≤ API —Å–µ—Ä–≤–∏—Å–µ
- –û—á–∏—â–∞–µ—Ç—Å—è –∫—ç—à –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞

### –î–µ–º–æ-—Ä–µ–∂–∏–º

1. –ù–∞ —ç–∫—Ä–∞–Ω–µ Setup –Ω–∞–∂–º–∏—Ç–µ "üé≠ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞ (–¥–µ–º–æ-—Ä–µ–∂–∏–º)"
2. –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `localStorage.setItem('demo_mode', 'true')`

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ñ–ª–∞–≥ `demo_mode`
- –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ

## API Endpoints

### –ë–∞–∑–æ–≤—ã–π URL

**–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (—á–µ—Ä–µ–∑ Vite proxy):**
- `/MobileSMARTS/api/v1` ‚Üí –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ `http://localhost:9000`

**–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è URL –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: `http://localhost:9000/MobileSMARTS/api/v1`

### –û—Å–Ω–æ–≤–Ω—ã–µ endpoints

- `GET /DocTypes` - —Å–ø–∏—Å–æ–∫ —Ç–∏–ø–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- `GET /Docs/{DocTypeName}` - —Å–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ —Ç–∏–ø—É
- `GET /Docs/{DocTypeName}('{id}')` - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
- `PATCH /Docs/{DocTypeName}('{id}')` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `PATCH /DocumentItem('{uid}')` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `POST /Docs/{DocTypeName}('{id}')/Default.EndUpdate` - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `GET /Products` - —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
- `GET /Cells` - —Å–ø–∏—Å–æ–∫ —è—á–µ–µ–∫

## –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞

`useDocumentLogic.updateLine()`:
1. –û–±–Ω–æ–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î (IndexedDB)
2. –î–æ–±–∞–≤–ª—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –≤ –æ—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
3. –ï—Å–ª–∏ –Ω–µ –¥–µ–º–æ-—Ä–µ–∂–∏–º ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `PATCH /DocumentItem('{uid}')` –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞

`useDocumentLogic.finishDocument()`:
1. –û–±–Ω–æ–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î
2. –î–æ–±–∞–≤–ª—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –≤ –æ—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
3. –ï—Å–ª–∏ –Ω–µ –¥–µ–º–æ-—Ä–µ–∂–∏–º ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `POST /Docs/{DocTypeName}('{id}')/Default.EndUpdate` –Ω–∞ —Å–µ—Ä–≤–µ—Ä

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –°–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏

–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –∫ API –Ω–µ —É–¥–∞–ª—Å—è:
1. –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –æ—à–∏–±–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª—å
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ fallback –Ω–∞ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)
3. UI –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### –û—à–∏–±–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–ï—Å–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å:
1. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
2. –î–µ–π—Å—Ç–≤–∏–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å –æ—Ñ–ª–∞–π–Ω-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ (–Ω–µ –±–ª–æ–∫–∏—Ä—É—é—â–µ–µ)

## –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–∂–∏–º–∞

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
localStorage.getItem('demo_mode') // 'true' –∏–ª–∏ null
configService.getServerUrl() // URL —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ ''
serverHealth.getCurrentStatus() // { isAvailable, isDemoMode, lastCheck }
```

### –õ–æ–≥–∏

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏:
- `üé≠ [DEMO]` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö
- `üì° [ODATA]` - –∑–∞–ø—Ä–æ—Å—ã –∫ OData API
- `‚úÖ [API]` - —É—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- `‚ùå [API]` - –æ—à–∏–±–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- `üîç [HEALTH]` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞** –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ API
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
3. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏ gracefully** - –Ω–µ –±–ª–æ–∫–∏—Ä—É–π—Ç–µ UI –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API
4. **–õ–æ–≥–∏—Ä—É–π—Ç–µ –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
5. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –æ–±–∞ —Ä–µ–∂–∏–º–∞** - –¥–µ–º–æ –∏ —Ä–µ–∞–ª—å–Ω—ã–π API

